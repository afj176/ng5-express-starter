{"version":3,"sources":["integration_testbed.es6"],"names":[],"mappings":"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","file":"angular2/test/render/dom/integration_testbed.js","sourcesContent":["import {assert} from \"rtts_assert/rtts_assert\";\nimport {isBlank,\n  isPresent,\n  BaseException} from 'angular2/src/facade/lang';\nimport {MapWrapper,\n  ListWrapper,\n  List,\n  Map} from 'angular2/src/facade/collection';\nimport {PromiseWrapper,\n  Promise} from 'angular2/src/facade/async';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {Parser,\n  Lexer} from 'angular2/change_detection';\nimport {DirectDomRenderer} from 'angular2/src/render/dom/direct_dom_renderer';\nimport {Compiler} from 'angular2/src/render/dom/compiler/compiler';\nimport {ProtoViewRef,\n  ProtoViewDto,\n  ViewDefinition,\n  ViewContainerRef,\n  EventDispatcher,\n  DirectiveMetadata} from 'angular2/src/render/api';\nimport {DefaultStepFactory} from 'angular2/src/render/dom/compiler/compile_step_factory';\nimport {TemplateLoader} from 'angular2/src/render/dom/compiler/template_loader';\nimport {UrlResolver} from 'angular2/src/services/url_resolver';\nimport {EmulatedUnscopedShadowDomStrategy} from 'angular2/src/render/dom/shadow_dom/emulated_unscoped_shadow_dom_strategy';\nimport {EventManager,\n  EventManagerPlugin} from 'angular2/src/render/dom/events/event_manager';\nimport {VmTurnZone} from 'angular2/src/core/zone/vm_turn_zone';\nimport {StyleUrlResolver} from 'angular2/src/render/dom/shadow_dom/style_url_resolver';\nimport {ViewFactory} from 'angular2/src/render/dom/view/view_factory';\nimport {RenderViewHydrator} from 'angular2/src/render/dom/view/view_hydrator';\nexport class IntegrationTestbed {\n  constructor({urlData,\n    viewCacheCapacity,\n    shadowDomStrategy,\n    templates}) {\n    this._templates = MapWrapper.create();\n    if (isPresent(templates)) {\n      ListWrapper.forEach(templates, (template) => {\n        MapWrapper.set(this._templates, template.componentId, template);\n      });\n    }\n    var parser = new Parser(new Lexer());\n    var urlResolver = new UrlResolver();\n    if (isBlank(shadowDomStrategy)) {\n      shadowDomStrategy = new EmulatedUnscopedShadowDomStrategy(new StyleUrlResolver(urlResolver), null);\n    }\n    var compiler = new Compiler(new DefaultStepFactory(parser, shadowDomStrategy), new FakeTemplateLoader(urlResolver, urlData));\n    if (isBlank(viewCacheCapacity)) {\n      viewCacheCapacity = 0;\n    }\n    if (isBlank(urlData)) {\n      urlData = MapWrapper.create();\n    }\n    this.eventPlugin = new FakeEventManagerPlugin();\n    var eventManager = new EventManager([this.eventPlugin], new FakeVmTurnZone());\n    var viewFactory = new ViewFactory(viewCacheCapacity, eventManager, shadowDomStrategy);\n    var viewHydrator = new RenderViewHydrator(eventManager, viewFactory, shadowDomStrategy);\n    this.renderer = new DirectDomRenderer(compiler, viewFactory, viewHydrator, shadowDomStrategy);\n  }\n  compileRoot(componentId) {\n    return assert.returnType((this.renderer.createHostProtoView(componentId).then((rootProtoView) => {\n      return this._compileNestedProtoViews(rootProtoView, [new DirectiveMetadata({\n        type: DirectiveMetadata.COMPONENT_TYPE,\n        id: componentId\n      })]);\n    })), assert.genericType(Promise, ProtoViewDto));\n  }\n  compile(componentId) {\n    var childTemplate = MapWrapper.get(this._templates, componentId);\n    if (isBlank(childTemplate)) {\n      throw new BaseException(`No template for component ${componentId}`);\n    }\n    return assert.returnType((this.renderer.compile(childTemplate).then((protoView) => {\n      return this._compileNestedProtoViews(protoView, childTemplate.directives);\n    })), assert.genericType(Promise, ProtoViewDto));\n  }\n  _compileNestedProtoViews(protoView, directives) {\n    var childComponentRenderPvRefs = [];\n    var nestedPVPromises = [];\n    ListWrapper.forEach(protoView.elementBinders, (elementBinder) => {\n      var nestedComponentId = null;\n      ListWrapper.forEach(elementBinder.directives, (db) => {\n        var directiveMeta = directives[db.directiveIndex];\n        if (directiveMeta.type === DirectiveMetadata.COMPONENT_TYPE) {\n          nestedComponentId = directiveMeta.id;\n        }\n      });\n      var nestedCall;\n      if (isPresent(nestedComponentId)) {\n        var childTemplate = MapWrapper.get(this._templates, nestedComponentId);\n        if (isBlank(childTemplate)) {\n          ListWrapper.push(childComponentRenderPvRefs, null);\n        } else {\n          nestedCall = this.compile(nestedComponentId);\n        }\n      } else if (isPresent(elementBinder.nestedProtoView)) {\n        nestedCall = this._compileNestedProtoViews(elementBinder.nestedProtoView, directives);\n      }\n      if (isPresent(nestedCall)) {\n        ListWrapper.push(nestedPVPromises, nestedCall.then((nestedPv) => {\n          elementBinder.nestedProtoView = nestedPv;\n          if (isPresent(nestedComponentId)) {\n            ListWrapper.push(childComponentRenderPvRefs, nestedPv.render);\n          }\n        }));\n      }\n    });\n    if (nestedPVPromises.length > 0) {\n      return assert.returnType((PromiseWrapper.all(nestedPVPromises).then((_) => {\n        this.renderer.mergeChildComponentProtoViews(protoView.render, childComponentRenderPvRefs);\n        return protoView;\n      })), assert.genericType(Promise, ProtoViewDto));\n    } else {\n      return assert.returnType((PromiseWrapper.resolve(protoView)), assert.genericType(Promise, ProtoViewDto));\n    }\n  }\n}\nclass FakeTemplateLoader extends TemplateLoader {\n  constructor(urlResolver, urlData) {\n    super(null, urlResolver);\n    this._urlData = urlData;\n  }\n  load(template) {\n    assert.argumentTypes(template, ViewDefinition);\n    if (isPresent(template.template)) {\n      return PromiseWrapper.resolve(DOM.createTemplate(template.template));\n    }\n    if (isPresent(template.absUrl)) {\n      var content = this._urlData[template.absUrl];\n      if (isPresent(content)) {\n        return PromiseWrapper.resolve(DOM.createTemplate(content));\n      }\n    }\n    return PromiseWrapper.reject('Load failed');\n  }\n}\nObject.defineProperty(FakeTemplateLoader.prototype.load, \"parameters\", {get: function() {\n    return [[ViewDefinition]];\n  }});\nexport class FakeVmTurnZone extends VmTurnZone {\n  constructor() {\n    super({enableLongStackTrace: false});\n  }\n  run(fn) {\n    fn();\n  }\n  runOutsideAngular(fn) {\n    fn();\n  }\n}\nexport class FakeEventManagerPlugin extends EventManagerPlugin {\n  constructor() {\n    super();\n    this._eventHandlers = MapWrapper.create();\n  }\n  dispatchEvent(eventName, event) {\n    MapWrapper.get(this._eventHandlers, eventName)(event);\n  }\n  supports(eventName) {\n    assert.argumentTypes(eventName, assert.type.string);\n    return assert.returnType((true), assert.type.boolean);\n  }\n  addEventListener(element, eventName, handler, shouldSupportBubble) {\n    assert.argumentTypes(element, assert.type.any, eventName, assert.type.string, handler, Function, shouldSupportBubble, assert.type.boolean);\n    MapWrapper.set(this._eventHandlers, eventName, handler);\n    return () => {\n      MapWrapper.delete(this._eventHandlers, eventName);\n    };\n  }\n}\nObject.defineProperty(FakeEventManagerPlugin.prototype.supports, \"parameters\", {get: function() {\n    return [[assert.type.string]];\n  }});\nObject.defineProperty(FakeEventManagerPlugin.prototype.addEventListener, \"parameters\", {get: function() {\n    return [[], [assert.type.string], [Function], [assert.type.boolean]];\n  }});\nexport class LoggingEventDispatcher extends EventDispatcher {\n  constructor() {\n    super();\n    this.log = [];\n  }\n  dispatchEvent(elementIndex, eventName, locals) {\n    assert.argumentTypes(elementIndex, assert.type.number, eventName, assert.type.string, locals, assert.genericType(Map, assert.type.string, assert.type.any));\n    ListWrapper.push(this.log, [elementIndex, eventName, locals]);\n  }\n}\nObject.defineProperty(LoggingEventDispatcher.prototype.dispatchEvent, \"parameters\", {get: function() {\n    return [[assert.type.number], [assert.type.string], [assert.genericType(Map, assert.type.string, assert.type.any)]];\n  }});\nexport class FakeEvent {\n  constructor(target) {\n    this.target = target;\n  }\n}\n//# sourceMappingURL=integration_testbed.js.map\n\n//# sourceMappingURL=./integration_testbed.map"]}