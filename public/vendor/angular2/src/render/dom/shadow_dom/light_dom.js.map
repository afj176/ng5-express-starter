{"version":3,"sources":["light_dom.es6"],"names":[],"mappings":"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","file":"angular2/src/render/dom/shadow_dom/light_dom.js","sourcesContent":["import {assert} from \"rtts_assert/rtts_assert\";\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {List,\n  ListWrapper} from 'angular2/src/facade/collection';\nimport {isBlank,\n  isPresent} from 'angular2/src/facade/lang';\nimport * as viewModule from '../view/view';\nimport {Content} from './content_tag';\nexport class DestinationLightDom {}\nclass _Root {\n  constructor(node, boundElementIndex) {\n    this.node = node;\n    this.boundElementIndex = boundElementIndex;\n  }\n}\nexport class LightDom {\n  constructor(lightDomView, shadowDomView, element) {\n    assert.argumentTypes(lightDomView, viewModule.RenderView, shadowDomView, viewModule.RenderView, element, assert.type.any);\n    this.lightDomView = lightDomView;\n    this.shadowDomView = shadowDomView;\n    this.nodes = DOM.childNodesAsList(element);\n    this.roots = null;\n  }\n  redistribute() {\n    redistributeNodes(this.contentTags(), this.expandedDomNodes());\n  }\n  contentTags() {\n    return assert.returnType((this._collectAllContentTags(this.shadowDomView, [])), assert.genericType(List, Content));\n  }\n  _collectAllContentTags(view, acc) {\n    assert.argumentTypes(view, viewModule.RenderView, acc, assert.genericType(List, Content));\n    var contentTags = view.contentTags;\n    var vcs = view.viewContainers;\n    for (var i = 0; i < vcs.length; i++) {\n      var vc = vcs[i];\n      var contentTag = contentTags[i];\n      if (isPresent(contentTag)) {\n        ListWrapper.push(acc, contentTag);\n      }\n      if (isPresent(vc)) {\n        ListWrapper.forEach(vc.contentTagContainers(), (view) => {\n          this._collectAllContentTags(view, acc);\n        });\n      }\n    }\n    return assert.returnType((acc), assert.genericType(List, Content));\n  }\n  expandedDomNodes() {\n    var res = [];\n    var roots = this._roots();\n    for (var i = 0; i < roots.length; ++i) {\n      var root = roots[i];\n      if (isPresent(root.boundElementIndex)) {\n        var vc = this.lightDomView.viewContainers[root.boundElementIndex];\n        var content = this.lightDomView.contentTags[root.boundElementIndex];\n        if (isPresent(vc)) {\n          res = ListWrapper.concat(res, vc.nodes());\n        } else if (isPresent(content)) {\n          res = ListWrapper.concat(res, content.nodes());\n        } else {\n          ListWrapper.push(res, root.node);\n        }\n      } else {\n        ListWrapper.push(res, root.node);\n      }\n    }\n    return assert.returnType((res), List);\n  }\n  _roots() {\n    if (isPresent(this.roots))\n      return this.roots;\n    var boundElements = this.lightDomView.boundElements;\n    this.roots = ListWrapper.map(this.nodes, (n) => {\n      var boundElementIndex = null;\n      for (var i = 0; i < boundElements.length; i++) {\n        var boundEl = boundElements[i];\n        if (isPresent(boundEl) && boundEl === n) {\n          boundElementIndex = i;\n          break;\n        }\n      }\n      return new _Root(n, boundElementIndex);\n    });\n    return this.roots;\n  }\n}\nObject.defineProperty(LightDom, \"parameters\", {get: function() {\n    return [[viewModule.RenderView], [viewModule.RenderView], []];\n  }});\nObject.defineProperty(LightDom.prototype._collectAllContentTags, \"parameters\", {get: function() {\n    return [[viewModule.RenderView], [assert.genericType(List, Content)]];\n  }});\nfunction redistributeNodes(contents, nodes) {\n  for (var i = 0; i < contents.length; ++i) {\n    var content = contents[i];\n    var select = content.select;\n    if (select.length === 0) {\n      content.insert(ListWrapper.clone(nodes));\n      ListWrapper.clear(nodes);\n    } else {\n      var matchSelector = (n) => DOM.elementMatches(n, select);\n      var matchingNodes = ListWrapper.filter(nodes, matchSelector);\n      content.insert(matchingNodes);\n      ListWrapper.removeAll(nodes, matchingNodes);\n    }\n  }\n  for (var i = 0; i < nodes.length; i++) {\n    var node = nodes[i];\n    if (isPresent(node.parentNode)) {\n      DOM.remove(nodes[i]);\n    }\n  }\n}\nObject.defineProperty(redistributeNodes, \"parameters\", {get: function() {\n    return [[assert.genericType(List, Content)], [List]];\n  }});\n//# sourceMappingURL=light_dom.js.map\n\n//# sourceMappingURL=./light_dom.map"]}